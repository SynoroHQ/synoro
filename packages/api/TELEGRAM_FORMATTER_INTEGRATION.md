# TelegramFormatterAgent Integration

## –û–±–∑–æ—Ä

`TelegramFormatterAgent` —Ç–µ–ø–µ—Ä—å **–≤—Å–µ–≥–¥–∞ —É—á–∞—Å—Ç–≤—É–µ—Ç** –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è Telegram, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ—Ç–≤–µ—Ç–æ–≤.

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É—á–∞—Å—Ç–∏–µ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ

**–†–∞–Ω—å—à–µ:** `TelegramFormatterAgent` –±—ã–ª –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –≤—ã–∑—ã–≤–∞–ª—Å—è.

**–¢–µ–ø–µ—Ä—å:** –ê–≥–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è Telegram.

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ AgentManager

–í `packages/api/src/lib/agents/agent-manager.ts` –¥–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤:

```typescript
// 8. –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –¥–ª—è Telegram, –µ—Å–ª–∏ —ç—Ç–æ Telegram –∫–∞–Ω–∞–ª
if (context.channel === "telegram" && finalResponse) {
  console.log("üì± Formatting response for Telegram...");

  const telegramFormatter = this.getAgent("telegram-formatter");
  if (telegramFormatter) {
    const formattingTask = this.createAgentTask(
      finalResponse,
      "telegram-formatting",
      context,
      1,
    );

    try {
      const formattingResult = await telegramFormatter.process(
        formattingTask,
        telemetry,
      );
      if (formattingResult.success && formattingResult.data) {
        result.finalResponse = formattingResult.data;
        agentsUsed.push(telegramFormatter.name);
        totalSteps++;
        console.log("‚úÖ Response formatted for Telegram");
      }
    } catch (error) {
      console.warn(
        "‚ö†Ô∏è Telegram formatting failed, using original response:",
        error,
      );
    }
  }
}
```

### 3. –£–ª—É—á—à–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ canHandle

`TelegramFormatterAgent` —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å, –∫–æ–≥–¥–∞ –µ–≥–æ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

```typescript
canHandle(task: AgentTask): Promise<boolean> {
  // –ê–≥–µ–Ω—Ç –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∑–∞–¥–∞—á–∏ –¥–ª—è Telegram
  const isFormattingTask = task.type === "telegram-formatting" ||
                          task.type === "formatting" ||
                          task.type === "telegram-response";

  const isTelegramChannel = task.context?.channel === "telegram";

  // –í—Å–µ–≥–¥–∞ —É—á–∞—Å—Ç–≤—É–µ–º –¥–ª—è Telegram –∫–∞–Ω–∞–ª–∞ –∏–ª–∏ –∑–∞–¥–∞—á —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  return Promise.resolve(isFormattingTask || isTelegramChannel);
}
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ RouterAgent

`RouterAgent` —Ç–µ–ø–µ—Ä—å –∑–Ω–∞–µ—Ç –æ `TelegramFormatterAgent` –∏ –º–æ–∂–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –µ–≥–æ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π.

## –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ–ø–µ—Ä—å

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ –æ—Ç–≤–µ—Ç—ã –¥–ª—è Telegram –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç—Å—è
2. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –ï–¥–∏–Ω—ã–π —Å—Ç–∏–ª—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
3. **–£–ª—É—á—à–µ–Ω–Ω–∞—è —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—å**: –≠–º–æ–¥–∑–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ Markdown —Ä–∞–∑–º–µ—Ç–∫–∞
4. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ê–≥–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### üîÑ –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram
2. –°–æ–æ–±—â–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∞–≥–µ–Ω—Ç–Ω—É—é —Å–∏—Å—Ç–µ–º—É
3. –ü–æ–ª—É—á–∞–µ—Ç—Å—è –æ—Ç–≤–µ—Ç –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `TelegramFormatterAgent`
5. –û—Ç–≤–µ—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è –¥–ª—è Telegram
6. –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### üì± –ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–î–æ:**

```
–í–∞—à –∑–∞–ø—Ä–æ—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω —É—Å–ø–µ—à–Ω–æ. –†–µ–∑—É–ª—å—Ç–∞—Ç: —Å—É–º–º–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ –∑–∞ —ç—Ç–æ—Ç –º–µ—Å—è—Ü —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 15000 —Ä—É–±–ª–µ–π. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤.
```

**–ü–æ—Å–ª–µ (—Å TelegramFormatterAgent):**

```
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–∞**

üìä **–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Å–≤–æ–¥–∫–∞**
–°—É–º–º–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ –∑–∞ —ç—Ç–æ—Ç –º–µ—Å—è—Ü: **15,000 —Ä—É–±–ª–µ–π**

üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**
–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

---
_–°–æ–∑–¥–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é Synoro AI_
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:

```bash
cd packages/api
bun test telegram-formatter-agent.test.ts
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–í –ª–æ–≥–∞—Ö –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
üì± Formatting response for Telegram...
‚úÖ Response formatted for Telegram
```

–ê–≥–µ–Ω—Ç —Ç–∞–∫–∂–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤:

```
üìä Agents used: Message Router ‚Üí QA Specialist ‚Üí Telegram Formatter
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

`TelegramFormatterAgent` —Ç–µ–ø–µ—Ä—å —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–æ—Ç—ä–µ–º–ª–µ–º–æ–π —á–∞—Å—Ç—å—é –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è Telegram, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –æ—Ç–≤–µ—Ç–æ–≤.
