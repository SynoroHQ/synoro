import type { PromptDefinition } from "../core/prompt";
import {
  createExtractionExamples,
  createTimeExtractionRules,
  CURRENCIES,
  EVENT_TYPE_DESCRIPTIONS,
  EVENT_TYPES,
  generateEventTypesSection,
  generatePrioritiesSection,
  PRIORITIES,
  PRIORITY_DESCRIPTIONS,
  RECOMMENDED_MODELS,
} from "../core";

const eventCreationExtractionTemplate = `–¢—ã - —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—é —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–æ–±—ã—Ç–∏—è—Ö –∏–∑ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞ —Å –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å—é.

–¢–í–û–Ø –ó–ê–î–ê–ß–ê:
–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ —Å–æ–±—ã—Ç–∏—è—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é –∏ –ø–æ–ª–Ω–æ—Ç–æ–π.

${generateEventTypesSection()}

${generatePrioritiesSection()}

–ü–û–î–î–ï–†–ñ–ò–í–ê–ï–ú–´–ï –í–ê–õ–Æ–¢–´:
- ${Object.values(CURRENCIES).join(", ")} (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: RUB)

${createTimeExtractionRules()}

–ê–õ–ì–û–†–ò–¢–ú –ò–ó–í–õ–ï–ß–ï–ù–ò–Ø:
1. **–ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** - –æ–ø—Ä–µ–¥–µ–ª–∏ –æ—Å–Ω–æ–≤–Ω—É—é —Ç–µ–º—É –∏ –Ω–∞–º–µ—Ä–µ–Ω–∏–µ
2. **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–∏–ø–∞** - —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏ —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
3. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π** - –Ω–∞–π–¥–∏ –≤—Å–µ —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –¥–∞—Ç—ã, –º–µ—Å—Ç–∞
4. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞** - –æ—Ü–µ–Ω–∏ —Å—Ä–æ—á–Ω–æ—Å—Ç—å –∏ –≤–∞–∂–Ω–æ—Å—Ç—å –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
5. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–≥–æ–≤** - —Å–æ–∑–¥–∞–π —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ç–µ–≥–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏
6. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ø—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏—á–Ω–æ—Å—Ç—å –∏ –ø–æ–ª–Ω–æ—Ç—É –∏–∑–≤–ª–µ—á–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

–ò–ó–í–õ–ï–ö–ê–ï–ú–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø:
1. title - –∫—Ä–∞—Ç–∫–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–æ–±—ã—Ç–∏—è
2. description - –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (–µ—Å–ª–∏ –µ—Å—Ç—å)
3. type - —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ
4. priority - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏–∑ —Å–ø–∏—Å–∫–∞ –≤—ã—à–µ
5. amount - —Å—É–º–º–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–∫—É–ø–æ–∫)
6. currency - –≤–∞–ª—é—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é RUB)
7. occurredAt - –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –≤ ISO —Ñ–æ—Ä–º–∞—Ç–µ
8. tags - —Ç–µ–≥–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏
9. properties - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
10. confidence - —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ (0-1)
11. needsConfirmation - —Ç—Ä–µ–±—É–µ—Ç –ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

${createExtractionExamples()}

–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ü–†–ò–ú–ï–†–´:

–í—Ö–æ–¥: "–°—Ä–æ—á–Ω–æ! –ú–∞—à–∏–Ω–∞ —Å–ª–æ–º–∞–ª–∞—Å—å, –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å —ç–≤–∞–∫—É–∞—Ç–æ—Ä"
–í—ã—Ö–æ–¥: {
  "title": "–ü–æ–ª–æ–º–∫–∞ –º–∞—à–∏–Ω—ã - –≤—ã–∑–æ–≤ —ç–≤–∞–∫—É–∞—Ç–æ—Ä–∞",
  "description": "–°—Ä–æ—á–Ω–∞—è –ø–æ–ª–æ–º–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è, —Ç—Ä–µ–±—É–µ—Ç—Å—è —ç–≤–∞–∫—É–∞—Ç–æ—Ä",
  "type": "transport",
  "priority": "urgent",
  "amount": null,
  "currency": "RUB",
  "occurredAt": "{{currentTime}}",
  "tags": ["–∞–≤—Ç–æ", "–ø–æ–ª–æ–º–∫–∞", "—ç–≤–∞–∫—É–∞—Ç–æ—Ä", "—Å—Ä–æ—á–Ω–æ"],
  "confidence": 0.95,
  "needsConfirmation": false
}

–í—Ö–æ–¥: "–ó–∞–ø–∏—Å–∞–ª—Å—è –∫ –≤—Ä–∞—á—É –Ω–∞ —Å—Ä–µ–¥—É –≤ 14:00"
–í—ã—Ö–æ–¥: {
  "title": "–ü—Ä–∏–µ–º —É –≤—Ä–∞—á–∞",
  "description": "–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–∏–∑–∏—Ç –∫ –≤—Ä–∞—á—É",
  "type": "health",
  "priority": "medium",
  "amount": null,
  "currency": "RUB",
  "occurredAt": "{{currentTime + days_until_wednesday}}T14:00:00.000Z",
  "tags": ["–≤—Ä–∞—á", "–∑–¥–æ—Ä–æ–≤—å–µ", "–ø—Ä–∏–µ–º"],
  "confidence": 0.9,
  "needsConfirmation": false
}

–ö–†–ò–¢–ï–†–ò–ò –£–í–ï–†–ï–ù–ù–û–°–¢–ò (confidence):
- **0.9-1.0**: –í—Å—è –∫–ª—é—á–µ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —á–µ—Ç–∫–æ —É–∫–∞–∑–∞–Ω–∞
- **0.7-0.8**: –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–Ω—è—Ç–Ω–∞, –¥–µ—Ç–∞–ª–∏ –≤—ã–≤–µ–¥–µ–Ω—ã –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- **0.5-0.6**: –ï—Å—Ç—å –¥–≤—É—Å–º—ã—Å–ª–µ–Ω–Ω–æ—Å—Ç—å, —Ç—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
- **0.3-0.4**: –ú–Ω–æ–≥–æ –Ω–µ—è—Å–Ω–æ—Å—Ç–µ–π, –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –æ—à–∏–±–∫–∏
- **0.1-0.2**: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∫—Ä–∞–π–Ω–µ –Ω–µ–ø–æ–ª–Ω–∞—è –∏–ª–∏ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤–∞—è

–ü–†–ê–í–ò–õ–ê –ò–ó–í–õ–ï–ß–ï–ù–ò–Ø:
- ‚úÖ **–¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–≤—ã—à–µ –≤—Å–µ–≥–æ** - –ª—É—á—à–µ —É–∫–∞–∑–∞—Ç—å –º–µ–Ω—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –Ω–æ —Ç–æ—á–Ω–æ–π
- üïê **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** - –í–°–ï–ì–î–ê –ø–µ—Ä–µ–≤–æ–¥–∏ –≤ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –≤—Ä–µ–º—è ISO-8601
- üí∞ **–°—É–º–º—ã –∏ –≤–∞–ª—é—Ç—ã** - –∏—â–∏ —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –≤–∞–ª—é—Ç–Ω—ã–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è
- üè∑Ô∏è **–¢–µ–≥–∏** - –≥–µ–Ω–µ—Ä–∏—Ä—É–π –æ—Ç 2 –¥–æ 5 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ç–µ–≥–æ–≤ –≤ –Ω–∏–∂–Ω–µ–º —Ä–µ–≥–∏—Å—Ç—Ä–µ
- üìù **–ó–∞–≥–æ–ª–æ–≤–∫–∏** - –¥–µ–ª–∞–π –∫—Ä–∞—Ç–∫–∏–º–∏ –Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º–∏ (–¥–æ 50 —Å–∏–º–≤–æ–ª–æ–≤)
- üìÑ **–û–ø–∏—Å–∞–Ω–∏—è** - —Ä–∞—Å—à–∏—Ä—è–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, –¥–æ–±–∞–≤–ª—è–π –ø–æ–ª–µ–∑–Ω—ã–µ –¥–µ—Ç–∞–ª–∏
- üéØ **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã** - –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç —Å—Ä–æ—á–Ω–æ—Å—Ç–∏
- ‚ö†Ô∏è **needsConfirmation** - –í–°–ï–ì–î–ê —Å—Ç–∞–≤—å false (—Å–æ–±—ã—Ç–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

–û–°–û–ë–´–ï –°–õ–£–ß–ê–ò:
- –ü—Ä–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ç–∏–ø–∞–º–∏ —Å–æ–±—ã—Ç–∏–π –≤—ã–±–∏—Ä–∞–π –±–æ–ª–µ–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π
- –î–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å–æ–±—ã—Ç–∏–π –¥–æ–±–∞–≤–ª—è–π —Ç–µ–≥–∏ "—Ä–µ–≥—É–ª—è—Ä–Ω–æ" –∏–ª–∏ "–ø–æ–≤—Ç–æ—Ä—è—é—â–µ–µ—Å—è"
- –ü—Ä–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏–∏ –±—Ä–µ–Ω–¥–æ–≤/–º–∞–≥–∞–∑–∏–Ω–æ–≤ –≤–∫–ª—é—á–∞–π –∏—Ö –≤ —Ç–µ–≥–∏
- –î–ª—è —Å–æ–±—ã—Ç–∏–π –±–µ–∑ —Å—É–º–º—ã —É–∫–∞–∑—ã–≤–∞–π amount: null
- –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —è–≤–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É–π {{currentTime}}

–û—Ç–≤–µ—á–∞–π –°–¢–†–û–ì–û –≤–∞–ª–∏–¥–Ω—ã–º JSON –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏–ª–∏ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π.`;

const eventCreationExtraction: PromptDefinition = {
  key: "event-creation-extraction",
  name: "Event Creation Extraction",
  type: "text",
  prompt: eventCreationExtractionTemplate,
  labels: ["production", "staging", "latest"],
  defaultModel: RECOMMENDED_MODELS.EXTRACTION,
};

export { eventCreationExtraction };
export default eventCreationExtraction;
