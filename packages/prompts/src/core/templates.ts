// –®–∞–±–ª–æ–Ω—ã –∏ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–º–ø—Ç–æ–≤

import {
  AGENT_DESCRIPTIONS,
  AGENTS,
  CONTEXT_VARIABLES,
  EVENT_TYPE_DESCRIPTIONS,
  EVENT_TYPES,
  EXPENSE_CATEGORIES,
  HTML_FORMATTING,
  PRIORITIES,
  PRIORITY_DESCRIPTIONS,
  QUALITY_PRINCIPLES,
  TASK_STATUS_DESCRIPTIONS,
  TASK_STATUSES,
  TELEGRAM_RESPONSE_GUIDELINES,
} from "./constants";

/**
 * –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –ø—Ä–æ–º–ø—Ç–æ–≤
 */
export function generateEventTypesSection(): string {
  return `–¢–ò–ü–´ –°–û–ë–´–¢–ò–ô:
${Object.entries(EVENT_TYPE_DESCRIPTIONS)
  .map(([type, description]) => `- ${type}: ${description}`)
  .join("\n")}`;
}

/**
 * –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–º–ø—Ç–æ–≤
 */
export function generatePrioritiesSection(): string {
  return `–ü–†–ò–û–†–ò–¢–ï–¢–´:
${Object.entries(PRIORITY_DESCRIPTIONS)
  .map(([priority, description]) => `- ${priority}: ${description}`)
  .join("\n")}`;
}

/**
 * –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–¥–∞—á –¥–ª—è –ø—Ä–æ–º–ø—Ç–æ–≤
 */
export function generateTaskStatusesSection(): string {
  return `–°–¢–ê–¢–£–°–´ –ó–ê–î–ê–ß:
${Object.entries(TASK_STATUS_DESCRIPTIONS)
  .map(([status, description]) => `- ${status}: ${description}`)
  .join("\n")}`;
}

/**
 * –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ä–∞—Å—Ö–æ–¥–æ–≤ –¥–ª—è –ø—Ä–æ–º–ø—Ç–æ–≤
 */
export function generateExpenseCategoriesSection(): string {
  return `–ö–ê–¢–ï–ì–û–†–ò–ò –†–ê–°–•–û–î–û–í:
- ${EXPENSE_CATEGORIES.join(", ")}`;
}

/**
 * –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤ –¥–ª—è —Ä–æ—É—Ç–µ—Ä–∞
 */
export function generateAgentsSection(): string {
  return `–î–û–°–¢–£–ü–ù–´–ï –ê–ì–ï–ù–¢–´:
${Object.entries(AGENT_DESCRIPTIONS)
  .map(
    ([agent, description], index) => `${index + 1}. ${agent} - ${description}`,
  )
  .join("\n")}`;
}

/**
 * –°–æ–∑–¥–∞–µ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–æ–º–ø—Ç–∞
 */
export function createPromptContext(additionalContext?: string): string {
  const sections = [CONTEXT_VARIABLES, additionalContext].filter(Boolean);

  return sections.join("\n\n");
}

/**
 * –°–æ–∑–¥–∞–µ—Ç —Å–µ–∫—Ü–∏—é —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–ª—è Telegram
 */
export function createTelegramFormattingSection(): string {
  return `${HTML_FORMATTING}

${TELEGRAM_RESPONSE_GUIDELINES}`;
}

/**
 * –°–æ–∑–¥–∞–µ—Ç –ø—Ä–∏–º–µ—Ä—ã –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è —Ä–æ—É—Ç–µ—Ä–∞
 */
export function createRouterExamples(): string {
  return `–ü–†–ò–ú–ï–†–´ –ö–õ–ê–°–°–ò–§–ò–ö–ê–¶–ò–ò:
- "–ü–æ—Ç—Ä–∞—Ç–∏–ª 500 —Ä—É–±–ª–µ–π –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç—ã" ‚Üí ${AGENTS.EVENT_PROCESSOR}
- "–ü–æ–∫–∞–∂–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ä–∞—Å—Ö–æ–¥–æ–≤ –∑–∞ –º–µ—Å—è—Ü" ‚Üí ${AGENTS.EVENT_ANALYZER}
- "–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ?" ‚Üí ${AGENTS.GENERAL_ASSISTANT}
- "–ó–∞–¥–∞—á–∞: –ø–æ–∑–≤–æ–Ω–∏—Ç—å –º–∞–º–µ" ‚Üí ${AGENTS.EVENT_PROCESSOR}
- "–°—Ä–∞–≤–Ω–∏ —Ä–∞—Å—Ö–æ–¥—ã —Å –ø—Ä–æ—à–ª—ã–º –º–µ—Å—è—Ü–µ–º" ‚Üí ${AGENTS.EVENT_ANALYZER}
- "–ß—Ç–æ —Ç–∞–∫–æ–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–æ–±—ã—Ç–∏–π?" ‚Üí ${AGENTS.GENERAL_ASSISTANT}

–ö–õ–Æ–ß–ï–í–´–ï –°–õ–û–í–ê:
üìù event-processor: –ø–æ—Ç—Ä–∞—Ç–∏–ª, –∫—É–ø–∏–ª, –∑–∞–ø–ª–∞—Ç–∏–ª, –∑–∞–¥–∞—á–∞, –∑–∞–ø–∏—Å—å, —Å–æ–∑–¥–∞—Ç—å, –¥–æ–±–∞–≤–∏—Ç—å, —Å–¥–µ–ª–∞–ª, –ø–æ—á–∏–Ω–∏–ª
üìä event-analyzer: —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –∞–Ω–∞–ª–∏–∑, –æ—Ç—á–µ—Ç, –ø–æ–∫–∞–∑–∞—Ç—å, —Å—Ä–∞–≤–Ω–∏, —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏, —Å–∫–æ–ª—å–∫–æ, –∑–∞ –ø–µ—Ä–∏–æ–¥
‚ùì general-assistant: –∫–∞–∫, —á—Ç–æ —Ç–∞–∫–æ–µ, –ø–æ–º–æ—â—å, –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –æ–±—ä—è—Å–Ω–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏`;
}

/**
 * –°–æ–∑–¥–∞–µ—Ç —Å–µ–∫—Ü–∏—é —Å –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã
 */
export function createQualitySection(): string {
  return QUALITY_PRINCIPLES;
}

/**
 * –°–æ–∑–¥–∞–µ—Ç —Å–µ–∫—Ü–∏—é –≤–∞–∂–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª –¥–ª—è –∞–≥–µ–Ω—Ç–∞
 */
export function createImportantRules(specificRules?: string[]): string {
  const baseRules = [
    "–£—á–∏—Ç—ã–≤–∞–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–∏–∞–ª–æ–≥–µ",
    "–†–∞–∑–≤–∏–≤–∞–π –¥–∏–∞–ª–æ–≥ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—è —É–∂–µ –æ–±—Å—É–∂–¥–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é",
    "–ì–æ–≤–æ—Ä–∏ –∫–∞–∫ –∂–∏–≤–æ–π —á–µ–ª–æ–≤–µ–∫, –∞ –Ω–µ –∫–∞–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∏–ª–∏ —Ä–æ–±–æ—Ç",
    "–ë—É–¥—å –ø–æ–ª–µ–∑–Ω—ã–º –∏ –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–º –≤ —Å–≤–æ–∏—Ö —Å–æ–≤–µ—Ç–∞—Ö",
  ];

  const allRules = specificRules ? [...baseRules, ...specificRules] : baseRules;

  return `–í–ê–ñ–ù–´–ï –ü–†–ê–í–ò–õ–ê:
${allRules.map((rule) => `- ${rule}`).join("\n")}`;
}

/**
 * –í—Ä–µ–º–µ–Ω–Ω—ã–µ —É–∫–∞–∑–∞–Ω–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
 */
export function createTimeExtractionRules(): string {
  return `–í–†–ï–ú–ï–ù–ù–´–ï –£–ö–ê–ó–ê–ù–ò–Ø:
- –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: {{currentTime}}
- –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å: {{timezone}}
- –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–π –≤—Å–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —É–∫–∞–∑–∞–Ω–∏—è ("–∑–∞–≤—Ç—Ä–∞", "—á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é", "–≤—á–µ—Ä–∞") –≤ –∞–±—Å–æ–ª—é—Ç–Ω–æ–µ –≤—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO-8601
- –ï—Å–ª–∏ –≤—Ä–µ–º—è –Ω–µ —É–∫–∞–∑–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–π {{currentTime}} –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO-8601
- –í—Å–µ –¥–∞—Ç—ã –¥–æ–ª–∂–Ω—ã —É—á–∏—Ç—ã–≤–∞—Ç—å —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å {{timezone}}`;
}

/**
 * –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
 */
export function createExtractionExamples(): string {
  return `–ü–†–ò–ú–ï–†–´ –ò–ó–í–õ–ï–ß–ï–ù–ò–Ø:

–í—Ö–æ–¥: "–ü–æ—Ç—Ä–∞—Ç–∏–ª 500 —Ä—É–±–ª–µ–π –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç—ã –≤ –ü—è—Ç–µ—Ä–æ—á–∫–µ"
–í—ã—Ö–æ–¥: {
  "title": "–ü–æ–∫—É–ø–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –ü—è—Ç–µ—Ä–æ—á–∫–µ",
  "description": "–ü–æ–∫—É–ø–∫–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –º–∞–≥–∞–∑–∏–Ω–µ –ü—è—Ç–µ—Ä–æ—á–∫–∞",
  "type": "purchase",
  "priority": "medium",
  "amount": 500,
  "currency": "RUB",
  "occurredAt": "{{currentTime}}",
  "tags": ["–ø—Ä–æ–¥—É–∫—Ç—ã", "–ø—è—Ç–µ—Ä–æ—á–∫–∞"],
  "confidence": 0.9,
  "needsConfirmation": false
}

–í—Ö–æ–¥: "–ó–∞–≤—Ç—Ä–∞ –Ω—É–∂–Ω–æ –ø–æ—á–∏–Ω–∏—Ç—å –∫—Ä–∞–Ω –≤ –≤–∞–Ω–Ω–æ–π"
–í—ã—Ö–æ–¥: {
  "title": "–ü–æ—á–∏–Ω–∏—Ç—å –∫—Ä–∞–Ω –≤ –≤–∞–Ω–Ω–æ–π",
  "description": "–†–µ–º–æ–Ω—Ç –∫—Ä–∞–Ω–∞ –≤ –≤–∞–Ω–Ω–æ–π –∫–æ–º–Ω–∞—Ç–µ",
  "type": "maintenance",
  "priority": "high",
  "amount": null,
  "currency": "RUB",
  "occurredAt": "{{currentTime + 1 day}}",
  "tags": ["—Ä–µ–º–æ–Ω—Ç", "—Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞", "–≤–∞–Ω–Ω–∞—è"],
  "confidence": 0.8,
  "needsConfirmation": false
}`;
}

/**
 * –°–æ–∑–¥–∞–µ—Ç –æ—Ü–µ–Ω–æ—á–Ω—É—é —à–∫–∞–ª—É –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞
 */
export function createQualityScale(): string {
  return `–®–ö–ê–õ–ê –û–¶–ï–ù–û–ö:
- 0.9-1.0: –û—Ç–ª–∏—á–Ω—ã–π –æ—Ç–≤–µ—Ç, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–≤
- 0.7-0.8: –•–æ—Ä–æ—à–∏–π –æ—Ç–≤–µ—Ç —Å –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º–∏ —É–ª—É—á—à–µ–Ω–∏—è–º–∏  
- 0.5-0.6: –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç, —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- 0.3-0.4: –°–ª–∞–±—ã–π –æ—Ç–≤–µ—Ç, —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- 0.0-0.2: –ù–µ–ø—Ä–∏–µ–º–ª–µ–º—ã–π –æ—Ç–≤–µ—Ç, —Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏`;
}

/**
 * –°–æ–∑–¥–∞–µ—Ç —ç–º–æ–¥–∑–∏-–∏–∫–æ–Ω–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–±—ã—Ç–∏–π
 */
export function getEventTypeIcon(eventType: string): string {
  const icons: Record<string, string> = {
    [EVENT_TYPES.PURCHASE]: "üõí",
    [EVENT_TYPES.MAINTENANCE]: "üîß",
    [EVENT_TYPES.HEALTH]: "üíä",
    [EVENT_TYPES.WORK]: "üíº",
    [EVENT_TYPES.PERSONAL]: "üë§",
    [EVENT_TYPES.TRANSPORT]: "üöó",
    [EVENT_TYPES.HOME]: "üè†",
    [EVENT_TYPES.FINANCE]: "üí∞",
    [EVENT_TYPES.EDUCATION]: "üìö",
    [EVENT_TYPES.ENTERTAINMENT]: "üéÆ",
    [EVENT_TYPES.TRAVEL]: "‚úàÔ∏è",
    [EVENT_TYPES.FOOD]: "üçΩÔ∏è",
    [EVENT_TYPES.OTHER]: "üìù",
  };

  return icons[eventType] || "üìù";
}

/**
 * –°–æ–∑–¥–∞–µ—Ç –ø—Ä–∏–º–µ—Ä—ã —Ö–æ—Ä–æ—à–∏—Ö –∏ –ø–ª–æ—Ö–∏—Ö –æ—Ç–≤–µ—Ç–æ–≤
 */
export function createResponseExamples(): string {
  return `–ü–†–ò–ú–ï–†–´ –•–û–†–û–®–ò–• –û–¢–í–ï–¢–û–í:
‚ùå –ü–ª–æ—Ö–æ: "–ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ: —Ä–µ–º–æ–Ω—Ç; –∏–∑–≤–ª–µ—á–µ–Ω–æ ‚Äî –∑–∞–º–µ–Ω–∞ –º–∞—Å–ª–∞ –≤ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ Logan, –ø—Ä–æ–±–µ–≥ 175000 –∫–º, –¥–∞—Ç–∞: {{currentTime}}. –î–∞–Ω–Ω—ã–µ –≤—ã–≥–ª—è–¥—è—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ."

‚úÖ –•–æ—Ä–æ—à–æ: "–ü–æ–Ω—è–ª! –ó–∞–ø–∏—Å–∞–ª –∑–∞–º–µ–Ω—É –º–∞—Å–ª–∞ –Ω–∞ Logan (175–∫ –∫–º). –ê –∫–∞–∫–æ–µ –º–∞—Å–ª–æ –∑–∞–ª–∏–ª–∏ –∏ —Å–∫–æ–ª—å–∫–æ –∑–∞–ø–ª–∞—Ç–∏–ª–∏? –ò —Ñ–∏–ª—å—Ç—Ä –º–µ–Ω—è–ª–∏? –≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ª—É—á—à–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–∞—Å—Ö–æ–¥—ã."

‚úÖ –ï—â–µ –ª—É—á—à–µ: "–û—Ç–ª–∏—á–Ω–æ! –ó–∞–ø–∏—Å–∞–ª –∑–∞–º–µ–Ω—É –º–∞—Å–ª–∞ –Ω–∞ Logan (175–∫ –∫–º). –ï—Å–ª–∏ —Å–∫–∞–∂–µ—à—å —Ç–∏–ø –º–∞—Å–ª–∞, —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ –º–µ–Ω—è–ª–∏ –ª–∏ —Ñ–∏–ª—å—Ç—Ä - –¥–æ–ø–æ–ª–Ω—é –∑–∞–ø–∏—Å—å. –ê —Ç–æ –ø–æ—Ç–æ–º –∑–∞–±—É–¥–µ—à—å –¥–µ—Ç–∞–ª–∏ üòä"`;
}
