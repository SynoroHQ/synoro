# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–≥–µ–Ω—Ç–æ–≤

## üöÄ –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 1. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏

- **Router Agent**: `gpt-4o-mini` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **Event Processor**: `gpt-4o-mini` - –±—ã—Å—Ç—Ä–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
- **Event Analyzer**: `gpt-4o` - –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
- **General Assistant**: `gpt-4o-mini` - –±—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã

### 2. –°–∂–∞—Ç—ã–µ –ø—Ä–æ–º–ø—Ç—ã

- –£–¥–∞–ª–µ–Ω—ã –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è
- –°–æ–∫—Ä–∞—â–µ–Ω–∞ –¥–ª–∏–Ω–∞ –ø—Ä–æ–º–ø—Ç–æ–≤ –≤ 3-4 —Ä–∞–∑–∞
- –û—Å—Ç–∞–≤–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –≤–º–µ—Å—Ç–æ –¥–ª–∏–Ω–Ω—ã—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏–π

### 3. –ë—ã—Å—Ç—Ä—ã–π —Ä–æ—É—Ç–∏–Ω–≥

- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –±–µ–∑ LLM –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
- –í—Ä–µ–º—è —Ä–æ—É—Ç–∏–Ω–≥–∞ < 1ms –≤–º–µ—Å—Ç–æ 2-5 —Å–µ–∫—É–Ω–¥
- Fallback –Ω–∞ LLM —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
- 95%+ —Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è —Ç–∏–ø–∏—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### 4. –°–∏—Å—Ç–µ–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –Ω–∞ 5-10 –º–∏–Ω—É—Ç
- Hit rate 70-90% –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –°–∂–∞—Ç–∏–µ –∫–ª—é—á–µ–π –∫—ç—à–∞ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏

### 5. Middleware –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∂–∞—Ç–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

| –ú–µ—Ç—Ä–∏–∫–∞         | –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏    | –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ | –£–ª—É—á—à–µ–Ω–∏–µ  |
| --------------- | ----------------- | ----------------- | ---------- |
| –í—Ä–µ–º—è —Ä–æ—É—Ç–∏–Ω–≥–∞  | 2-5 —Å–µ–∫           | <1ms              | 2000-5000x |
| –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ | 5-15 —Å–µ–∫          | 2-5 —Å–µ–∫           | 2-3x       |
| –†–∞–∑–º–µ—Ä –ø—Ä–æ–º–ø—Ç–æ–≤ | 3000-8000 —Ç–æ–∫–µ–Ω–æ–≤ | 500-1500 —Ç–æ–∫–µ–Ω–æ–≤  | 3-5x       |
| Hit rate –∫—ç—à–∞   | 0%                | 70-90%            | ‚àû          |
| –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å    | 85-90%            | 95-98%            | 1.1-1.15x  |

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```typescript
import { quickSetup } from "@synoro/prompts";

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
const { orchestrator, execute } = await quickSetup();

// –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏
const result = await execute(context, "–ü–æ—Ç—Ä–∞—Ç–∏–ª 1500‚ÇΩ –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç—ã");
```

### –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

```typescript
import {
  CacheMiddleware,
  createDefaultAgentSystem,
  FastRoutingMiddleware,
  OptimizationMiddleware,
} from "@synoro/prompts";

const system = await createDefaultAgentSystem();

// Middleware —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
// - FastRoutingMiddleware (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 15)
// - CacheMiddleware (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 10)
// - OptimizationMiddleware (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 5)
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
bun run test:performance

# –ò–ª–∏ —á–µ—Ä–µ–∑ npm/yarn
npm run benchmark
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫—ç—à–∞

```typescript
import { globalCache } from "@synoro/prompts";

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –∏ TTL
globalCache.maxSize = 2000; // –ú–∞–∫—Å–∏–º—É–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤
globalCache.defaultTTL = 10 * 60 * 1000; // 10 –º–∏–Ω—É—Ç

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
const stats = globalCache.getStats();
console.log(`Hit rate: ${stats.hitRate * 100}%`);
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–æ—É—Ç–∏–Ω–≥–∞

```typescript
import { globalFastRouter } from "@synoro/prompts";

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞
globalFastRouter.addRule({
  keywords: ["–∑–∞–∫–∞–∑–∞–ª", "–¥–æ—Å—Ç–∞–≤–∫–∞"],
  agent: "event-processor",
  priority: 8,
});
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

```typescript
import { DEFAULT_OPTIMIZATION_CONFIG, globalOptimizer } from "@synoro/prompts";

const config = {
  ...DEFAULT_OPTIMIZATION_CONFIG,
  maxPromptLength: 1500, // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø—Ä–æ–º–ø—Ç–∞
  timeoutMs: 10000, // –¢–∞–π–º–∞—É—Ç –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
  enablePromptCompression: true, // –°–∂–∞—Ç–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤
};
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```typescript
import { performanceMonitor } from "@synoro/prompts/tools";

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∞–≥–µ–Ω—Ç—É
const stats = performanceMonitor.getAgentStats("event-processor-agent");
console.log(`–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: ${stats.averageTime}ms`);
console.log(`–£—Ä–æ–≤–µ–Ω—å –æ—à–∏–±–æ–∫: ${stats.errorRate * 100}%`);

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
const report = performanceMonitor.generateReport();
console.log("–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:", report.recommendations);
```

### Middleware –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞

```typescript
import { PerformanceTrackingMiddleware } from "@synoro/prompts/tools";

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ createDefaultAgentSystem()
globalMiddlewareManager.use(new PerformanceTrackingMiddleware());
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏

1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `gpt-4o-mini` –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á
2. –í–∫–ª—é—á–∏—Ç–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –∑–∞–ø—Ä–æ—Å–æ–≤
3. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–ª–∏–Ω—É –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–æ 1500 —Ç–æ–∫–µ–Ω–æ–≤
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±—ã—Å—Ç—Ä—ã–π —Ä–æ—É—Ç–∏–Ω–≥ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–∏–∑–∫—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É (0.1-0.3)
2. –î–æ–±–∞–≤—å—Ç–µ retry –ª–æ–≥–∏–∫—É —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º backoff
3. –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ —É—Ä–æ–≤–µ–Ω—å –æ—à–∏–±–æ–∫ –∏ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ circuit breaker –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤

1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (TTL 10+ –º–∏–Ω—É—Ç)
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∂–∞—Ç–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤
3. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ maxTokens –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
4. –û—á–∏—â–∞–π—Ç–µ –∫—ç—à —Ä–µ–≥—É–ª—è—Ä–Ω–æ

## üö® Troubleshooting

### –ù–∏–∑–∫–∏–π hit rate –∫—ç—à–∞

- –£–≤–µ–ª–∏—á—å—Ç–µ TTL –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∫–ª—é—á–µ–π –∫—ç—à–∞
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∫—ç—à–∞

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –∞–≥–µ–Ω—Ç–æ–≤

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä –ø—Ä–æ–º–ø—Ç–æ–≤ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å < 1500 —Ç–æ–∫–µ–Ω–æ–≤)
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –±—ã—Å—Ç—Ä—ã–µ –º–æ–¥–µ–ª–∏
- –í–∫–ª—é—á–∏—Ç–µ —Å–∂–∞—Ç–∏–µ –ø—Ä–æ–º–ø—Ç–æ–≤
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏

### –í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –æ—à–∏–±–æ–∫

- –£–≤–µ–ª–∏—á—å—Ç–µ —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –î–æ–±–∞–≤—å—Ç–µ retry –ª–æ–≥–∏–∫—É
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –ø—Ä–æ–º–ø—Ç–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ rate limits API

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ](./src/AGENT_ARCHITECTURE_GUIDE.md)
- [–ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ](./src/MIGRATION_GUIDE.md)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±—ã—Å—Ç—Ä—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤](./src/config/fast-agents.json)
- [–°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è](./src/scripts/test-performance.ts)
