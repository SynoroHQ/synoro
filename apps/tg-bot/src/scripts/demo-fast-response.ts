#!/usr/bin/env bun

/**
 * üöÄ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è Fast Response System
 *
 * –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
 * –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫–∏–µ –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —á–µ—Ä–µ–∑ –º—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–æ–≤
 */
import { fastResponseSystem } from "../utils/fast-response-system";

console.log("üöÄ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è Fast Response System\n");

// –¢–µ—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
const testMessages = [
  "–ü—Ä–∏–≤–µ—Ç!",
  "–°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–º–æ—â—å!",
  "–ö–æ—Ç–æ—Ä—ã–π —á–∞—Å?",
  "–ö–∞–∫–∞—è —Å–µ–≥–æ–¥–Ω—è –¥–∞—Ç–∞?",
  "–ß—Ç–æ —É–º–µ–µ—à—å?",
  "–ö–∞–∫ –¥–µ–ª–∞?",
  "–ü–æ–∫–∞!",
  "–ö–∞–∫ –º–Ω–µ —Å–æ–∑–¥–∞—Ç—å —Å–ª–æ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è?",
  "–ü–æ–º–æ–≥–∏ –º–Ω–µ —Å –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∑–∞–¥–∞—á –Ω–∞ –∑–∞–≤—Ç—Ä–∞",
  "–û–∫, –ø–æ–Ω—è—Ç–Ω–æ",
  "–î–∞, —Å–æ–≥–ª–∞—Å–µ–Ω",
];

console.log("üìù –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π:\n");

testMessages.forEach((message, index) => {
  console.log(`${index + 1}. –°–æ–æ–±—â–µ–Ω–∏–µ: "${message}"`);

  const response = fastResponseSystem.analyzeMessage(message);

  if (response.shouldSendFast) {
    console.log(`   ‚ö° Fast Response: ${response.fastResponse}`);
    console.log(
      `   üîÑ –ù—É–∂–Ω–∞ –ø–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: ${response.needsFullProcessing ? "–î–∞" : "–ù–µ—Ç"}`,
    );
    console.log(`   üìä –¢–∏–ø –æ–±—Ä–∞–±–æ—Ç–∫–∏: ${response.processingType}`);
  } else {
    console.log(`   ü§ñ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –º—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç—ã`);
    console.log(
      `   üîÑ –ù—É–∂–Ω–∞ –ø–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: ${response.needsFullProcessing ? "–î–∞" : "–ù–µ—Ç"}`,
    );
    console.log(`   üìä –¢–∏–ø –æ–±—Ä–∞–±–æ—Ç–∫–∏: ${response.processingType}`);
  }

  console.log();
});

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–∞–≤–∏–ª
console.log("üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–∞–≤–∏–ª Fast Response System:");
const stats = fastResponseSystem.getStats();
console.log(`   –í—Å–µ–≥–æ –ø—Ä–∞–≤–∏–ª: ${stats.totalRules}`);
console.log();

console.log("üîß –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∞–≤–∏–ª:");
stats.rules.slice(0, 5).forEach((rule, index) => {
  console.log(`   ${index + 1}. –ü–∞—Ç—Ç–µ—Ä–Ω: ${rule.pattern}`);
  console.log(`      –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: ${(rule.confidence * 100).toFixed(0)}%`);
  console.log(
    `      –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: ${rule.needsFullProcessing ? "–î–∞" : "–ù–µ—Ç"}`,
  );
  console.log();
});

// –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞
console.log("‚ûï –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Å—Ç–æ–º–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:");
const customRule = {
  pattern: /–ø–æ–≥–æ–¥–∞/i,
  response:
    "üå§Ô∏è –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —è –Ω–µ –º–æ–≥—É –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–≥–æ–¥—É. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã!",
  confidence: 0.8,
  needsFullProcessing: false,
};

fastResponseSystem.addRule(customRule);
console.log(`   –î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è "–ø–æ–≥–æ–¥–∞"`);

// –¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ
const weatherResponse = fastResponseSystem.analyzeMessage(
  "–ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ —Å–µ–≥–æ–¥–Ω—è?",
);
console.log(
  `   –¢–µ—Å—Ç: "–ö–∞–∫–∞—è –ø–æ–≥–æ–¥–∞ —Å–µ–≥–æ–¥–Ω—è?" ‚Üí ${weatherResponse.fastResponse}`,
);
console.log();

console.log("üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Fast Response System:");
const benefits = [
  "‚ö° –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è",
  "üöÄ –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç",
  "üí° –†–∞–∑–≥—Ä—É–∑–∫–∞ –º—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã",
  "üîÑ –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª",
  "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥",
  "üé® –õ–µ–≥–∫–∞—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤",
];

benefits.forEach((benefit) => {
  console.log(`   ${benefit}`);
});

console.log();
console.log("‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! Fast Response System –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!");
